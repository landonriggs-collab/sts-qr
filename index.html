<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STS QR Code Generator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="qr"></div>
    <input type="text" id="url-input" placeholder="Enter URL">
    <button id="btn-generate">Generate</button>
    <button id="btn-svg">Download SVG</button>
    <button id="btn-png">Download PNG (hi-res)</button>

    <script src="https://unpkg.com/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>
    <script>
        // Select DOM elements
        const urlInput = document.querySelector('#url-input');
        const generateBtn = document.querySelector('#btn-generate');
        const svgBtn = document.querySelector('#btn-svg');
        const pngBtn = document.querySelector('#btn-png');
        const qrContainer = document.querySelector('#qr');

        // Create QR code instance
        const qrCode = new QRCodeStyling({
            width: 320,
            height: 320,
            data: document.querySelector('#url-input').value,
            qrOptions: {
                errorCorrectionLevel: 'H'
            },
            image: 'assets/images/sts-logo.png',
            imageOptions: {
                imageSize: 0.15,
                margin: 4,
                crossOrigin: 'anonymous'
            },
            dotsOptions: {
                type: 'square',
                color: '#000000'
            },
            backgroundOptions: {
                color: '#FFFFFF'
            },
            margin: 24 // quiet zone
        });

        // Append QR code to container
        qrCode.append(qrContainer);

        // Generate button click handler
        generateBtn.addEventListener('click', () => {
            qrCode.update({
                data: urlInput.value
            });
        });

        // SVG download button click handler
        svgBtn.addEventListener('click', () => {
            qrCode.download({
                extension: 'svg',
                name: 'STS-FAC1-M03'
            });
        });

        // PNG download button click handler
        pngBtn.addEventListener('click', async () => {
            // Set high resolution
            qrCode.update({
                width: 1920,
                height: 1920
            });
            
            // Wait for the update to complete
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // Download PNG
            await qrCode.download({
                extension: 'png',
                name: 'STS-FAC1-M03'
            });
            
            // Restore original size
            qrCode.update({
                width: 320,
                height: 320
            });
        });
    </script>
</body>
</html>